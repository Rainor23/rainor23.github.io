<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>CTF Site Scanner (Python) | RainerInfoSec</title>
<meta name="description" content="A simple script to grab all url’s and comments from a source page.">


  <meta name="author" content="Rainer">
  
  <meta property="article:author" content="Rainer">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_GB">
<meta property="og:site_name" content="RainerInfoSec">
<meta property="og:title" content="CTF Site Scanner (Python)">
<meta property="og:url" content="http://0.0.0.0:4000/scripting/python/ctf/CTF-Site-Scanner/">


  <meta property="og:description" content="A simple script to grab all url’s and comments from a source page.">



  <meta property="og:image" content="http://0.0.0.0:4000/assets/imgs/hacker3.jpg">





  <meta property="article:published_time" content="2021-01-01T00:00:00-06:00">





  

  


<link rel="canonical" href="http://0.0.0.0:4000/scripting/python/ctf/CTF-Site-Scanner/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Rainer",
      "url": "http://0.0.0.0:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="RainerInfoSec Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          RainerInfoSec
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: url('/assets/imgs/hacker3.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        CTF Site Scanner (Python)

      </h1>
      

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/imgs/me.jpg" alt="Rainer" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rainer</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>After previously working in IT / infrastructure support, I am currently studying Cyber Security &amp; Computer Forensics at Kingston University. With a wide scope of knowledge, I am very keen to prove myself within the Cyber Security field.</p>

<p>With anyone familiar with the pentesting site Hack The Box, my profile can be seen here https://www.hackthebox.eu/profile/79594</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">UK / Norway</span>
        </li>
      

      
        
          
        
          
        
          
            <li><a href="https://twitter.com/Rainer_InfoSec" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/Rainor23" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">categories</span>
        

        
        <ul>
          
            <li><a href="/reverse_engineering/">Reverse Engineering</a></li>
          
            <li><a href="/web_application/">Web Application</a></li>
          
            <li><a href="/scripting/">Scripting</a></li>
          
            <li><a href="/hack_the_box/">Hack The Box</a></li>
          
            <li><a href="/AD/">Active Directory</a></li>
          
            <li><a href="/encryption/">Encryption</a></li>
          
            <li><a href="/research/">Research</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="CTF Site Scanner (Python)">
    <meta itemprop="description" content="A simple script to grab all url’s and comments from a source page.">
    <meta itemprop="datePublished" content="2021-01-01T00:00:00-06:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <h1 id="simple-ctf-script">Simple CTF script</h1>
<hr />

<p>You’re doing a CTF and your wordlist isn’t finding any directories… maybe they are using custom url’s on purpose so that the wordlist won’t work? Maybe they’ve hidden comments in the source code to point to a dev area? It can be annoying to search through, even more so when there is a large page with a ton of source code!</p>

<p>I created this script to look through html and find interesting elements, such as urls, comments and soon to be, hidden html elements. In scope of this project will be the ability for recursive searching using a word list.</p>

<p><strong>What does it do?</strong>
This script will pull the site source code, look for any urls and comments, then parse them out.</p>

<p>Updates to come:</p>
<ul>
  <li>Search for hidden html elements.</li>
  <li>Ability to search multiple urls and output them together in one output.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span><span class="p">,</span> <span class="n">Comment</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1">#Colour list
</span><span class="n">ansi_Black</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[30m"</span>
<span class="n">ansi_Red</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[31m"</span>
<span class="n">ansi_Green</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[32m"</span>
<span class="n">ansi_Yellow</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[33m"</span>
<span class="n">ansi_Blue</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[34m"</span>
<span class="n">ansi_Magenta</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[35m"</span>
<span class="n">ansi_Cyan</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[36m"</span>
<span class="n">ansi_White</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[37m"</span>
<span class="n">ansi_Reset</span> <span class="o">=</span> <span class="s">"</span><span class="se">\u001b</span><span class="s">[0m"</span>

<span class="c1">#Windows has weird python bug, where it won't load ANSI colors unless cls is run first, so... we run cls
#os.system("cls")
</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Error: Too many positional arguments! "</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Error: You must provide a URL'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">startswith</span><span class="p">(</span><span class="s">"http://"</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">startswith</span><span class="p">(</span><span class="s">"https://"</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Error: You must provide http:// or https://'</span><span class="p">)</span>

<span class="n">URL</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>

<span class="c1">#Search URLS
</span><span class="n">href_Arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">href_Arr</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">link</span><span class="p">[</span><span class="s">'href'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">f'</span><span class="si">{</span><span class="n">ansi_Red</span><span class="si">}</span><span class="s">Starting search.... </span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">f'''</span><span class="si">{</span><span class="n">ansi_Yellow</span><span class="si">}</span><span class="s">URLS found on webpage </span><span class="si">{</span><span class="n">URL</span><span class="si">}{</span><span class="n">ansi_Reset</span><span class="si">}</span><span class="s">
============================================== </span><span class="se">\n</span><span class="s"> </span><span class="si">{</span><span class="n">ansi_Cyan</span><span class="si">}</span><span class="s">'''</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">href_Arr</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">f"</span><span class="si">{</span><span class="n">ansi_Reset</span><span class="si">}</span><span class="s">=============================================="</span><span class="p">)</span>

<span class="c1">#Search for comments
</span><span class="n">comments_arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">comments</span> <span class="ow">in</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="k">lambda</span> <span class="n">text</span><span class="p">:</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">Comment</span><span class="p">)):</span>
    <span class="n">comments_arr</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">comments</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">f'''</span><span class="si">{</span><span class="n">ansi_Yellow</span><span class="si">}</span><span class="s">Comments found on webpage </span><span class="si">{</span><span class="n">URL</span><span class="si">}{</span><span class="n">ansi_Reset</span><span class="si">}</span><span class="s">
============================================== </span><span class="se">\n</span><span class="si">{</span><span class="n">ansi_Green</span><span class="si">}</span><span class="s">'''</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">comments_arr</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">f"</span><span class="si">{</span><span class="n">ansi_Reset</span><span class="si">}</span><span class="s">=============================================="</span><span class="p">)</span></code></pre></figure>

<p>Example output (From http://RainerInfoSec.com)
<img src="/assets/imgs/site_script1.PNG" alt="Script Output" /></p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#ctf" class="page__taxonomy-item" rel="tag">CTF</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#python" class="page__taxonomy-item" rel="tag">python</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#scripting" class="page__taxonomy-item" rel="tag">scripting</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-01-01T00:00:00-06:00">January 1, 2021</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=CTF+Site+Scanner+%28Python%29%20http%3A%2F%2F0.0.0.0%3A4000%2Fscripting%2Fpython%2Fctf%2FCTF-Site-Scanner%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2F0.0.0.0%3A4000%2Fscripting%2Fpython%2Fctf%2FCTF-Site-Scanner%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2F0.0.0.0%3A4000%2Fscripting%2Fpython%2Fctf%2FCTF-Site-Scanner%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/juiceshop/JuiceBox-Level-1-Walkthrough/" class="pagination--pager" title="JUICESHOP LEVEL 1
">Previous</a>
    
    
      <a href="/activedirectory/LLMNR-Poisoning/" class="pagination--pager" title="LLMNR Poisoning
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/activedirectory/LLMNR-Poisoning/" rel="permalink">LLMNR Poisoning
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">An article to show LLNMR Poisoning
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/juiceshop/JuiceBox-Level-1-Walkthrough/" rel="permalink">JUICESHOP LEVEL 1
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here we will go through Juiceshop Level 1

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/misc/Users-are-dangerous/" rel="permalink">USERS ARE DANGEROUS
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Users are at the forefront of most experiences when external users or customers interact with a company…
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Rainer. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
